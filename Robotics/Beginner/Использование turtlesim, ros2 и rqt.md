Turtlesim — это легкий симулятор для изучения ROS 2. Он иллюстрирует, что делает ROS 2 на самом базовом уровне, чтобы дать вам представление о том, что вы будете делать с настоящим роботом или симуляцией робота позже.

Инструмент ros2 — это то, как пользователь управляет, анализирует и взаимодействует с системой ROS. Он поддерживает несколько команд, которые нацелены на различные аспекты системы и ее работы. Его можно использовать для запуска узла, установки параметра, прослушивания темы и многого другого. Инструмент ros2 является частью базовой установки ROS 2.

rqt — это графический пользовательский интерфейс (GUI) для ROS 2. Все, что делается в rqt, можно делать в командной строке, но rqt предоставляет более удобный способ управления элементами ROS 2.

В этом руководстве рассматриваются основные концепции ROS 2, такие как узлы, темы и службы. Все эти концепции будут подробно рассмотрены в последующих руководствах; сейчас вы просто настроите инструменты и почувствуете их.

### 1. Установить turtlesim

Как всегда, начните с поиска файлов установки в новом терминале, как описано в [[Настройка среды|предыдущем руководстве]].

Установите пакет turtlesim для вашего дистрибутива ROS 2 (Linux):

```
sudo apt update

sudo apt install ros-jazzy-turtlesim
```

Проверьте, установлен ли пакет:

```
ros2 pkg executables turtlesim
```

Приведенная выше команда должна вернуть список исполняемых файлов turtlesim:

```
turtlesim draw_square
turtlesim mimic
turtlesim turtle_teleop_key
turtlesim turtlesim_node
```

![[Using turtlesim, ros2 and rqt_1.png]]
### 2. Запуск turtlesim

Чтобы запустить turtlesim, введите в терминале следующую команду:

```
ros2 run turtlesim turtlesim_node
```

Должно появиться окно симулятора со случайной черепахой в центре.

![[Using turtlesim, ros2 and rqt_2.png]]

В терминале вы увидите сообщения от узла:

```
[INFO] [turtlesim]: Starting turtlesim with node name /turtlesim
[INFO] [turtlesim]: Spawning turtle [turtle1] at x=[5.544445], y=[5.544445], theta=[0.000000]
```

![[Using turtlesim, ros2 and rqt_3.png]]

Там вы можете увидеть имя черепахи по умолчанию и координаты места ее появления.

### 3. Использование turtlesim

Теперь можно запустить новый узел для управления черепашкой в ​​первом узле:

```
ros2 run turtlesim turtle_teleop_key
```

На этом этапе у нас должно быть открыто три окна: терминал с запущенным turtlesim_node, терминал с запущенным turtle_teleop_key и окно turtlesim. Расположим эти окна так, чтобы мы могли видеть окно turtlesim, но также сделаем терминал с запущенным turtle_teleop_key активным, чтобы мы могли управлять черепашкой в ​​turtlesim.

Для управления используются клавиши со стрелками на клавиатуре. Черепаха будет двигаться по экрану, используя прикрепленную к ней «ручку», чтобы рисовать путь, по которому она прошла.

![[Launch_1.png]]

### 4. Установка rqt

Установка в новом терминале:

```
sudo apt update

sudo apt install '~nros-jazzy-rqt*'
```

Для запуска:

```
rqt
```

### 5. Использование rqt

При первом запуске rqt окно будет пустым. Выбираем Plugins > Services > Service Caller в строке меню вверху.

Если «Плагины» открыты, но нет «Службы» или каких-либо других параметров, то закрываем rqt и вводим команду `rqt --force-discover` в терминале.

![[Using turtlesim, ros2 and rqt_4.png]]

### 5.1 Использование сервиса spawn

Используем rqt для вызова сервиса `/spawn`. Из его названия можно догадаться, что `/spawn` создаст еще одну черепаху в окне turtlesim.

Дадим новой черепахе уникальное имя, например `turtle2`, дважды щелкнув между пустыми одинарными кавычками в столбце Expression. Мы увидим, что это выражение соответствует значению name и имеет тип string.

Затем введем некоторые координаты, в которых будет создана новая черепаха, например `x = 1.0` и `y = 1.0`.

Чтобы вызвать `turtle2`, нам нужно вызвать службу, нажав кнопку **Call** в правом верхнем углу окна rqt.

Если вызов службы был успешным, мы увидим новую черепашку (опять же со случайным дизайном), которая появится в координатах, которые мы ввели для **x** и **y**.

Если мы обновим список служб в rqt, мы также увидим, что теперь есть службы, связанные с новой черепашкой, `/turtle2/...`, в дополнение к `/turtle1/...`.

### 5.2 Попробуем сервис set_pen

Теперь дадим `turtle1` уникальную ручку с помощью сервиса `/set_pen`:

Значения **r**, **g** и **b**, находящиеся в диапазоне от 0 до 255, задают цвет пера, которым рисует `turtle1`, а **width** задает толщину линии.
### 6. Переназначение

Нам нужен второй узел `teleop` для управления `turtle2`. Однако если мы попытаетесь запустить ту же команду, что и раньше, то заметим, что она также управляет `turtle1`. Изменить это поведение можно, переназначив заголовок`cmd_vel`.

В новом терминале запустим source ROS 2 и выполним:

```
ros2 run turtlesim turtle_teleop_key --ros-args --remap turtle1/cmd_vel:=turtle2/cmd_vel
```

Теперь вы можете перемещать `turtle2`, когда этот терминал активен, и `turtle1`, когда активен другой терминал, на котором запущен `turtle_teleop_key`.

![[Using turtlesim, ros2 and rqt_5.png]]

### 7. Остановка

Чтобы остановить симуляцию, вводим Ctrl + C в терминале turtlesim_node и q в терминалах turtle_teleop_key.

Следующее: **[[Понимание узлов]]**